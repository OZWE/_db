function play(){document.getElementById("bPlay").style.display="none";document.getElementById("bPause").style.display="inline";player.play();return!1}function pause(){document.getElementById("bPlay").style.display="inline";document.getElementById("bPause").style.display="none";player.pause();return!1}function startedPlay(){$("html, body").animate({scrollTop:$("#a"+currentSnd).offset().top-50},1e3)}function endedPlay(){next()}function setCurrentSnd(e){currentSnd=e;location.hash=e;player.src="data/"+audioFiles[currentSnd].snd;$("#viz a").removeClass("current");$("#a"+currentSnd).addClass("current");"/tmp/"+audioFiles[currentSnd]["pict"]!=$("#diaPict").attr("src")&&$("#diaPictFrame").fadeOut(kFadeDuration,function(){if(audioFiles[currentSnd].pict!==""){$("#diaPict").attr("src","/tmp/"+audioFiles[currentSnd].pict);$("#diaPictText").html('<a href="'+audioFiles[currentSnd].pict_link+'" target="_blank">'+audioFiles[currentSnd].pict_cred+"</a>")}});$("#links").fadeOut(kFadeDuration,function(){if(audioFiles[currentSnd].link!==""){$("#links").html(audioFiles[currentSnd].link);$("#links").fadeIn()}})}function playTrack(e){player.pause();setCurrentSnd(e);play();return!1}function next(){if(currentSnd<audioFiles.length-1){setCurrentSnd(currentSnd+1);play()}else alert("End of the track.");return!1}function openLink(e){$("#overlay iframe").attr("src",e);$("#overlay").fadeIn();return!1}function hideOverlay(){$("#overlay").fadeOut();$("#overlay iframe").attr("src","");return!1}function start(){setCurrentSnd(0);$("#wait").fadeOut();playTrack(currentSnd);return!1}function home(){window.location.href="/"}function toggleMute(){player.muted=!player.muted;$("#bMute").attr("src","/i/audio_"+(player.muted?"on":"mute")+".png")}function toggleMode(){if($("#viz").offset().left<0){$("#bMode").attr("src","/i/mode_full.png");$("#viz").animate({"margin-left":0});$("#dia").animate({left:$("#viz").width()+60})}else{$("#bMode").attr("src","/i/mode_list.png");$("#viz").animate({"margin-left":-($("#viz").width()+60)});$("#dia").animate({left:0})}return!1}var currentSnd=-1,player=document.getElementById("player"),kFadeDuration=200;if(window.location.hash){$("#wait").hide();playTrack(parseInt(window.location.hash.substring(1),10))}$(document).ready(function(){$("#diaPict").load(function(){$("#diaPictFrame").fadeIn()});$("#bBack").click(function(e){e.preventDefault();home()});$("#bMode").click(function(e){e.preventDefault();toggleMode()});$("#bPlay").click(function(e){e.preventDefault();play()});$("#bPause").click(function(e){e.preventDefault();pause()});$("#bNext").click(function(e){e.preventDefault();next()});$("#bMute").click(function(e){e.preventDefault();toggleMute()});$("#links a.entity").click(function(e){e.preventDefault();e.stopPropagation();openLink($(this).attr("href"))});$("#wait a").click(function(e){e.preventDefault();start()});$("#overlay .close").click(function(e){e.preventDefault();hideOverlay()})});